
<html>
<head>
<link rel='stylesheet' type='text/css' href='style.css'>
</head>
<body>
<div class="centered">
<table>
<tr>
<td>Line</td>
<td>Hotness</td>
<td>Optimization</td>
<td>Source</td>
<td>Inline Context</td>
</tr>

<tr>
<td><a name="L1">1</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span><span class="cm">/* stringlib: count implementation */</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L2">2</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L3">3</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span><span class="cp">#ifndef STRINGLIB_FASTSEARCH_H</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L4">4</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span><span class="cp">#error must include &quot;stringlib/fastsearch.h&quot; before including this module</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L5">5</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span><span class="cp">#endif</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L6">6</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L7">7</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span><span class="n">Py_LOCAL_INLINE</span><span class="p">(</span><span class="n">Py_ssize_t</span><span class="p">)</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L8">8</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span><span class="n">STRINGLIB</span><span class="p">(</span><span class="n">count</span><span class="p">)(</span><span class="k">const</span> <span class="n">STRINGLIB_CHAR</span><span class="o">*</span> <span class="n">str</span><span class="p">,</span> <span class="n">Py_ssize_t</span> <span class="n">str_len</span><span class="p">,</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L9">9</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>                <span class="k">const</span> <span class="n">STRINGLIB_CHAR</span><span class="o">*</span> <span class="n">sub</span><span class="p">,</span> <span class="n">Py_ssize_t</span> <span class="n">sub_len</span><span class="p">,</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L10">10</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>                <span class="n">Py_ssize_t</span> <span class="n">maxcount</span><span class="p">)</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L11">11</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span><span class="p">{</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L12">12</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>    <span class="n">Py_ssize_t</span> <span class="n">count</span><span class="p">;</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L13">13</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L14">14</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="p">(</span><span class="n">str_len</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L15">15</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* start &gt; len(str) */</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L16">16</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="p">(</span><span class="n">sub_len</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L17">17</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>        <span class="k">return</span> <span class="p">(</span><span class="n">str_len</span> <span class="o">&lt;</span> <span class="n">maxcount</span><span class="p">)</span> <span class="o">?</span> <span class="n">str_len</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">maxcount</span><span class="p">;</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L18">18</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L19">19</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>    <span class="n">count</span> <span class="o">=</span> <span class="n">FASTSEARCH</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">str_len</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">sub_len</span><span class="p">,</span> <span class="n">maxcount</span><span class="p">,</span> <span class="n">FAST_COUNT</span><span class="p">);</span>
</pre></div>
</td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_stringlib_count.h.html#L9>stringlib_count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> will not be inlined into stringlib_count&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_stringlib_count.h.html#L9>stringlib_count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_stringlib_transmogrify.h.html#L353>stringlib_replace_delete_substring</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> will not be inlined into stringlib_replace_delete_substring&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_stringlib_transmogrify.h.html#L353>stringlib_replace_delete_substring</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_stringlib_transmogrify.h.html#L569>stringlib_replace_substring</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> will not be inlined into stringlib_replace_substring&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_stringlib_transmogrify.h.html#L569>stringlib_replace_substring</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_stringlib_transmogrify.h.html#L638>stringlib_replace</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> will not be inlined into stringlib_replace&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_stringlib_transmogrify.h.html#L638>stringlib_replace</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_bytesobject.c.html#L2246>bytes_replace_impl</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> will not be inlined into bytes_replace_impl&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_bytesobject.c.html#L2246>bytes_replace_impl</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_clinic_bytesobject.c.h.html#L372>bytes_replace</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> will not be inlined into bytes_replace&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_clinic_bytesobject.c.h.html#L372>bytes_replace</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> can be inlined into stringlib_count with cost=310 (threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_stringlib_count.h.html#L9>stringlib_count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-green">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> inlined into stringlib_count&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_stringlib_count.h.html#L9>stringlib_count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>asciilib_fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow">asciilib_count</td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>asciilib_fastsearch</a> will not be inlined into asciilib_count&nbsp;</span></td>
<td class="column-entry-yellow">asciilib_count</td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs1lib_fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow">ucs1lib_count</td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs1lib_fastsearch</a> will not be inlined into ucs1lib_count&nbsp;</span></td>
<td class="column-entry-yellow">ucs1lib_count</td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs2lib_fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow">ucs2lib_count</td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs2lib_fastsearch</a> will not be inlined into ucs2lib_count&nbsp;</span></td>
<td class="column-entry-yellow">ucs2lib_count</td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> Not inlining. Cost of inlining <a href=Objects_stringlib_fastsearch.h.html#L133>ucs4lib_fastsearch</a> increases the cost of inlining ucs4lib_count in other contexts&nbsp;</span></td>
<td class="column-entry-yellow">ucs4lib_count</td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs4lib_fastsearch</a> will not be inlined into ucs4lib_count&nbsp;</span></td>
<td class="column-entry-yellow">ucs4lib_count</td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>asciilib_fastsearch</a> can be inlined into PyUnicode_Count with cost=310 (threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_unicodeobject.c.html#L9410>PyUnicode_Count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-green">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>asciilib_fastsearch</a> inlined into PyUnicode_Count&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_unicodeobject.c.html#L9410>PyUnicode_Count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>asciilib_fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_unicodeobject.c.html#L10442>anylib_count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>asciilib_fastsearch</a> will not be inlined into anylib_count&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_unicodeobject.c.html#L10442>anylib_count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs4lib_fastsearch</a> can be inlined into anylib_count with cost=310 (threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_unicodeobject.c.html#L10442>anylib_count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-green">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs4lib_fastsearch</a> inlined into anylib_count&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_unicodeobject.c.html#L10442>anylib_count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs2lib_fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_unicodeobject.c.html#L10486>replace</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs2lib_fastsearch</a> will not be inlined into replace&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_unicodeobject.c.html#L10486>replace</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs1lib_fastsearch</a> can be inlined into unicode_count with cost=310 (threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_unicodeobject.c.html#L11441>unicode_count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-green">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>ucs1lib_fastsearch</a> inlined into unicode_count&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_unicodeobject.c.html#L11441>unicode_count</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_bytearrayobject.c.html#L1320>bytearray_replace_impl</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> will not be inlined into bytearray_replace_impl&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_bytearrayobject.c.html#L1320>bytearray_replace_impl</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-white">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> too costly to inline (cost=325, threshold=325)&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_clinic_bytearrayobject.c.h.html#L142>bytearray_replace</a></td>
</tr>

<tr>
<td></td>
<td></td>
<td class="column-entry-red">inline</td>
<td><pre style="display:inline">            </pre><span class="column-entry-yellow"> <a href=Objects_stringlib_fastsearch.h.html#L133>fastsearch</a> will not be inlined into bytearray_replace&nbsp;</span></td>
<td class="column-entry-yellow"><a href=Objects_clinic_bytearrayobject.c.h.html#L142>bytearray_replace</a></td>
</tr>

<tr>
<td><a name="L20">20</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L21">21</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L22">22</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* no match */</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L23">23</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L24">24</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>    <span class="k">return</span> <span class="n">count</span><span class="p">;</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L25">25</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L26">26</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>
</pre></div>
</td>
</tr>

<tr>
<td><a name="L27">27</a></td>
<td></td>
<td></td>
<td><div class="highlight"><pre><span></span>
</pre></div>
</td>
</tr>

</table>
</body>
</html>
